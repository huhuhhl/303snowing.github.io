## Kali Linux学习笔记
---

* ### 局域网断网攻击

    * 局域网ip扫描：
    > fping -asg [host]
    更多参数使用 fping -help
    ```shell
    eg: fping -asg 192.168.0.0
    ```
    
    * 局域网断网攻击：
    > arpspoof [-i interface] [-c own|host|both] [-t target] [-r] host
    ```shell
    eg: arpspoof -i eth0 -t 192.168.0.101 192.168.0.0
    ```
    * 网关
    > 网关工作在OSI七层模型中的传输层或者应用层，用于高层协议的不同网络之间的连接，简单地说，网关就好比是一个房间通向另一个房间的一扇门。
    
    * ARP
    > ARP（Address Resolution Protocol）地址转换协议，工作在OSI模型的数据链路层，在以太网中，网络设备之间互相通信是用MAC地址而不是IP地址，ARP协议就是用来把IP地址转换为MAC地址的。而RARP和ARP相反，它是反向地址转换协议，把MAC地址转换为IP地址。
    
    * **ARP欺骗**
    > 简单说就是目标IP流量通过我的网卡，再从网关流出，如果不流出，则目标机器断网
    ARP 欺骗分为两种，一种是双向欺骗，一种是单向欺骗
    >>
    > 1. 单向ARP欺骗
    >> 掐断 A 与 B 的通讯，实现原理：C 向 A 发送一条 Arp 数据包，内容为：B 的地址是 00:00:00:00:00:00 （一个错误的地址），那么 A 此后向 B 发的数据包都会发到 00，而这个地址是错误的，所以通讯中断了，但是要注意了，这里只是 A –> B 中断了，B –> A 没有中断，所以这个叫单向欺骗。
    >>>
    >> 掐断 B 与 A 的通讯，实现原理和第一条一样，如果和第一条一起发，那么 A 和 B 的通讯就完全中断了，即：A <– × –> B
    >>>
    >> 嗅探 A 与 B 的通讯，实现原理：C 向 A 发送一条 Arp 数据包，内容为：B 的地址是 AA:BB:CC:DD:EE:FF （C自己的地址），也就是说，C 对 A 说：我才是 B，于是 A 把向 B 发送的数据都发给 C 了，C 得到数据后就可以为所欲为了，可以直接丢弃，那么通讯中断，也可以再次转发给 B，那么又形成回路，C 当了个中间人，监视 A 和 B 的通讯，此时你就可以用CAIN等任何抓包工具进行本地嗅探了，因为目标机器数据完全从你这你走，任意嗅探。当然你可以不转发所有数据，只转发部分数据， 把某些特定协议的数据分离出来，然后单独处理，例如替换、修改（类似 zxarp 等 Arp 工具的插入、劫持数据功能），或者干点其他啥，都行。
    >>
    > 2. 双向ARP欺骗
    >> A要跟C正常通讯，B向A说我是才C。B向C说我才是A，那么这样的情况下把A跟C的ARP缓存表全部修改了。以后通讯过程就是 A把数据发送给B,B在发送给C，C把数据发送B，B在把数据给A。
    >>>
    >> 攻击主机发送ARP应答包给被攻击主机和网关，它们分别修改其ARP缓存表为, 修改的全是攻击主机的MAC地址，这样它们之间数据都被攻击主机截获。
    
    * 流量转发
    > 将目标IP流入网卡的流量转发到ipv4协议流出
    > echo 1 >/proc/sys/net/ipv4/ip_forward
    > ！*echo是写命令，不会有任何回显的*
    
    * 获取网卡流量中的图片
    > driftnet -i [interface]
    ```shell
    eg: driftnet -i eth0
    ```
    ![操作结果示例][arp_eg]


  [arp_eg]: ./images/1507053684582.jpg